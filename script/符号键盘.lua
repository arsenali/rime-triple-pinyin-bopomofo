require "import"
import "android.widget.*"
import "android.view.*"
import "android.graphics.RectF"
import "android.graphics.drawable.StateListDrawable"
import "android.os.*"
import "com.osfans.trime.*" --è½½å…¥åŒ…

local Emoji={ --å­˜æ”¾è¡¨æƒ…çš„table
  --{æŒ‰é”®å,ç¬¦å·table æˆ– æ–‡æœ¬}
  {"123",[[+123()-456[]*789{}/,0.@=Ã¸Ã˜Ï€Â°â€²â€³ï¼„ï¿¥ã€’ï¿ ï¿¡ï¼…ï¼ â„ƒâ„‰ï¹©ï¹ªâ€°ï¹«ã¡ã¥ã•mlãœãããmÂ³ããã„molã’ã‘Âºâ—‹Â¤%$ÂºÂ¹Â²Â³â´â¿â‚â‚‚â‚ƒâ‚„â‚¬Â£Ò°â‚´$â‚°Â¢â‚¤Â¥â‚³â‚²â‚ªâ‚µå…ƒâ‚£â‚±à¸¿Â¤â‚¡â‚®â‚­â‚©Şƒå††â‚¢â‚¥â‚«â‚¦zÅ‚ï·¼â‚ â‚§â‚¯â‚¨KÄà¤°â‚¹Æ’â‚¸ï¿ ]]}, --[[é•¿æ–‡æœ¬ï¼Œå¯æ¢è¡Œ]]
  {"ä¸­æ–‡",{"ï¼Œ","ã€‚","ï¼Ÿ","ï¼","ï¼š","ã€","@","â€¦â€¦","â€œâ€","ï¼›","â€˜â€™","â€”â€”","ï¼ˆï¼‰","ã€Šã€‹","ã€ˆã€‰","ã€”ã€•","ï¼»ï¼½","ã€ã€‘","*","&","+","-","Ã—","Ã·","=","#","ï¿¥","%","Ë‡","Â·","â€¢","ï½"}},
  {"è‹±æ–‡",{",",".","?","!",":","/","^","*",";",'"',"'","#","{","}","_","@","(",")","[","]",'`','~',"$","|","+","-","=","<",">","...","&","â’¶","â’·","â’¸","â’¹","â’º","â’»","â’¼","â’½","â’¾","â’¿","â“€","â“","â“‚","â“ƒ","â“„","â“…","â“†","â“‡","â“ˆ","â“‰","â“Š","â“‹","â“Œ","â“","â“","â“"}},
  {"è¡¨æƒ…",[[ğŸ¥¶ğŸ¤¬ğŸ¤¢ğŸ¥µğŸ˜‹ğŸ¤ğŸ¤®ğŸ˜ğŸ¤—ğŸ˜¶ğŸ˜ğŸ¤”ğŸ˜´ğŸ¤“ğŸ˜â˜ºğŸ˜ªğŸ˜¨ğŸ˜³ğŸ˜€ğŸ˜ğŸ˜‚ğŸ˜ƒğŸ˜„ğŸ˜…ğŸ˜†ğŸ˜‰ğŸ˜ŠğŸ˜‹ğŸ˜ğŸ˜ğŸ˜˜ğŸ˜—ğŸ˜™ğŸ˜šâ˜ºğŸ˜‡ğŸ˜ğŸ˜‘ğŸ˜¶ğŸ˜ğŸ˜£ğŸ˜¥ğŸ˜®ğŸ˜¯ğŸ˜ªğŸ˜«ğŸ˜´ğŸ˜ŒğŸ˜›ğŸ˜œğŸ˜ğŸ˜’ğŸ˜“ğŸ˜”ğŸ˜•ğŸ˜²ğŸ˜·ğŸ˜–ğŸ˜ğŸ˜ŸğŸ˜¤ğŸ˜¢ğŸ˜­ğŸ˜¦ğŸ˜§ğŸ˜¨ğŸ˜¬ğŸ˜°ğŸ˜±ğŸ˜³ğŸ˜µğŸ˜¡ğŸ˜ ğŸ‘¦ğŸ‘§ğŸ‘¨ğŸ‘©ğŸ‘´ğŸ‘µğŸ‘¶ğŸ‘±ğŸ‘®ğŸ‘²ğŸ‘³ğŸ‘·ğŸ‘¸ğŸ’‚ğŸ…ğŸ‘°ğŸ‘¼ğŸ’†ğŸ’‡ğŸ™ğŸ™ğŸ™…ğŸ™†ğŸ’ğŸ™‹ğŸ™‡ğŸ™ŒğŸ™ğŸ‘¤ğŸ‘¥ğŸš¶ğŸƒğŸ‘¯ğŸ’ƒğŸ‘«ğŸ‘¬ğŸ‘­ğŸ’ğŸ’‘ğŸ‘ªğŸ’ªğŸ‘ˆğŸ‘‰â˜ğŸ‘†ğŸ‘‡âœŒâœ‹ğŸ‘ŒğŸ‘ğŸ‘âœŠğŸ‘ŠğŸ‘‹ğŸ‘ğŸ‘ğŸ–•ğŸ––ğŸ¤ŸğŸ¤ğŸ’©ğŸ‘»ğŸ‘¿ğŸ’‹ğŸŒ‚ğŸ‘ âœğŸ‘£ğŸ‘€ğŸ‘‚ğŸ‘ƒğŸ‘…ğŸ‘„ğŸ’‹ğŸ‘“ğŸ‘”ğŸ‘•ğŸ‘–ğŸ‘—ğŸ‘˜ğŸ‘™ğŸ‘šğŸ‘›ğŸ‘œğŸ‘ğŸ’ğŸ’¼ğŸ‘ğŸ‘ŸğŸ‘ ğŸ‘¡ğŸ‘¢ğŸ‘‘ğŸ‘’ğŸ©ğŸ“ğŸ’„ğŸ’…ğŸ’ğŸŒ‚ğŸ“±ğŸ“²ğŸ“¶ğŸ“³ğŸ“´â˜ğŸ“ğŸ“ŸğŸ“ â™»ğŸ§ğŸš®ğŸš°â™¿ğŸš¹ğŸšºğŸš»ğŸš¼ğŸš¾âš ğŸš¸â›”ğŸš«ğŸš³ğŸš­ğŸš¯ğŸš±ğŸš·ğŸ”ğŸ’ˆğŸ˜ˆğŸ‘¿ğŸ‘¹ğŸ‘ºğŸ’€â˜ ğŸ‘»ğŸ‘½ğŸ‘¾ğŸ’£ğŸğŸ‚ğŸ…ğŸ‡ğŸ‰ğŸğŸğŸğŸ’ğŸ“ğŸ•ğŸ–ğŸ¦ ğŸ¦ŸğŸ¦…ğŸœğŸ•¸ğŸğŸ¦€ğŸ¶ğŸ¦ŠğŸ™ğŸ¦ğŸ¤ğŸ¦…ğŸğŸ›ğŸ¦–ğŸ¦ğŸ ğŸŸğŸ¦›ğŸ˜ğŸ¾ğŸ·ğŸ½ğŸ¸ğŸ¦‡ğŸ¦ğŸ™ˆğŸ™‰ğŸ™ŠğŸµğŸ’ğŸ¶ğŸ•ğŸ©ğŸºğŸ±ğŸ˜ºğŸ˜¸ğŸ˜¹ğŸ˜»ğŸ˜¼ğŸ˜½ğŸ™€ğŸ˜¿ğŸ˜¾ğŸˆğŸ¯ğŸ…ğŸ†ğŸ´ğŸğŸ®ğŸ‚ğŸƒğŸ„ğŸ·ğŸ–ğŸ—ğŸ½ğŸğŸ‘ğŸğŸªğŸ«ğŸ˜ğŸ­ğŸğŸ€ğŸ¹ğŸ°ğŸ‡ğŸ»ğŸ¨ğŸ¼ğŸ¾ğŸ”ğŸ“ğŸ¦†ğŸ¦¢ğŸ•ŠğŸ¦œğŸ¦‰ğŸ£ğŸ¤ğŸ¥ğŸ¦ğŸ§ğŸ¸ğŸŠğŸ¢ğŸğŸ²ğŸ‰ğŸ³ğŸ‹ğŸ¬ğŸŸğŸ ğŸ¡ğŸ™ğŸšğŸŒğŸ›ğŸœğŸğŸğŸ¦‹ğŸ’ğŸŒ¸ğŸ’®ğŸŒ¹ğŸŒºğŸŒ»ğŸŒ¼ğŸŒ·ğŸŒ±ğŸŒ²ğŸŒ³ğŸŒ´ğŸŒµğŸŒ¾ğŸŒ¿ğŸ€ğŸğŸ‚ğŸƒğŸŒğŸŒğŸŒğŸŒğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜ğŸŒ™ğŸŒšğŸŒ›ğŸŒœâ˜€ğŸŒğŸŒâ­ğŸŒŸğŸŒ â˜â›…â˜”âš¡â„ğŸ”¥ğŸ’§ğŸŒŠğŸ‡ğŸˆğŸ‰ğŸŠğŸ‹ğŸŒğŸğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ…ğŸ†ğŸŒ½ğŸ„ğŸŒ°ğŸğŸ–ğŸ—ğŸ”ğŸŸğŸ•ğŸ³ğŸ²ğŸ±ğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸ ğŸ¢ğŸ£ğŸ¤ğŸ¥ğŸ¡ğŸ¦ğŸ§ğŸ¨ğŸ©ğŸªğŸ‚ğŸ°ğŸ«ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸ¼â˜•ğŸµğŸ¶ğŸ·ğŸ¸ğŸ¹ğŸºğŸ»ğŸ´ğŸ ğŸ¡ğŸ¢ğŸ£ğŸ¤ğŸ¥ğŸ¦ğŸ¨ğŸ©ğŸªğŸ«ğŸ¬ğŸ­ğŸ¯ğŸ°ğŸ’’ğŸ—¼ğŸ—½â›ªğŸŒ†ğŸŒ‡ğŸŒ‰ğŸš‚ğŸšƒğŸš„ğŸš…ğŸš†ğŸš‡ğŸšˆğŸš‰ğŸšŠğŸšğŸšğŸš‹ğŸšŒğŸšğŸšğŸšğŸšğŸš‘ğŸš’ğŸš“ğŸš”ğŸš•ğŸš–ğŸš—ğŸš˜ğŸššğŸš›ğŸšœğŸš²â›½ğŸš¨ğŸš¥ğŸš¦ğŸš§âš“â›µğŸš£ğŸš¤ğŸš¢âœˆğŸ’ºğŸšğŸšŸğŸš ğŸš¡ğŸš€ğŸŒ‹ğŸ—»ğŸ ğŸ¡ğŸ¢ğŸ£ğŸ¤ğŸ¥ğŸ¦ğŸ¨ğŸ©ğŸªğŸ«ğŸ¬ğŸ­ğŸ¯ğŸ°ğŸ’’ğŸ—¼ğŸ—½â›ªâ›²ğŸŒğŸŒƒğŸŒ†ğŸŒ‡ğŸŒ‰ğŸŒŒğŸ ğŸ¡ğŸ¢ğŸš‚ğŸšƒğŸš„ğŸš…ğŸš†ğŸš‡ğŸšˆğŸš‰ğŸšŠğŸšğŸšğŸš‹ğŸšŒğŸšğŸšğŸšğŸšğŸš‘ğŸš’ğŸš“ğŸš”ğŸš•ğŸš–ğŸš—ğŸš˜ğŸššğŸš›ğŸšœğŸš²â›½ğŸš¨ğŸš¥ğŸš¦ğŸš§âš“â›µğŸš¤ğŸš¢âœˆğŸ’ºğŸšğŸšŸğŸš ğŸš¡ğŸš€ğŸ‘ğŸ—¿ğŸ›‚ğŸ›ƒğŸ›„ğŸ›…ğŸ’ŒğŸ’ğŸ”ªğŸ’ˆğŸšªğŸš½ğŸš¿ğŸ›âŒ›â³âŒšâ°ğŸˆğŸ‰ğŸŠğŸğŸğŸğŸ€ğŸğŸ“¯ğŸ“»ğŸ“±ğŸ“²â˜ğŸ“ğŸ“ŸğŸ“ ğŸ”‹ğŸ”ŒğŸ’»ğŸ’½ğŸ’¾ğŸ’¿ğŸ“€ğŸ¥ğŸ“ºğŸ“·ğŸ“¹ğŸ“¼ğŸ”ğŸ”ğŸ”¬ğŸ”­ğŸ“¡ğŸ’¡ğŸ”¦ğŸ®ğŸ“”ğŸ“•ğŸ“–ğŸ“—ğŸ“˜ğŸ“™ğŸ“šğŸ““ğŸ“ƒğŸ“œğŸ“„ğŸ“°ğŸ“‘ğŸ”–ğŸ’°ğŸ’´ğŸ’µğŸ’¶ğŸ’·ğŸ’¸ğŸ’³âœ‰ğŸ“§ğŸ“¨ğŸ“©ğŸ“¤ğŸ“¥ğŸ“¦ğŸ“«ğŸ“ªğŸ“¬ğŸ“­ğŸ“®âœâœ’ğŸ“ğŸ“ğŸ“‚ğŸ“…ğŸ“†ğŸ“‡ğŸ“ˆğŸ“‰ğŸ“ŠğŸ“‹ğŸ“ŒğŸ“ğŸ“ğŸ“ğŸ“âœ‚ğŸ”’ğŸ”“ğŸ”ğŸ”ğŸ”‘ğŸ”¨ğŸ”«ğŸ”§ğŸ”©ğŸ”—ğŸ’‰ğŸ’ŠğŸš¬ğŸ”®ğŸš©ğŸŒğŸ’¦ğŸ’¨ğŸ“±ğŸ“²â˜ğŸ“ğŸ“ŸğŸ“ ğŸ”‹ğŸ”ŒğŸ’»ğŸ’½ğŸ’¾ğŸ’¿ğŸ“€ğŸ¥ğŸ“ºğŸ“·ğŸ“¹ğŸ“¼ğŸ”ğŸ”ğŸ”¬ğŸ”­ğŸ“¡ğŸ“”ğŸ“•ğŸ“–ğŸ“—ğŸ“˜ğŸ“™ğŸ“šğŸ““ğŸ“ƒğŸ“œğŸ“„ğŸ“°ğŸ“‘ğŸ”–ğŸ’³âœ‰ğŸ“§ğŸ“¨ğŸ“©ğŸ“¤ğŸ“¥ğŸ“¦ğŸ“«ğŸ“ªğŸ“¬ğŸ“­ğŸ“®âœâœ’ğŸ“ğŸ“ğŸ“‚ğŸ“…ğŸ“†ğŸ“‡ğŸ“ˆğŸ“‰ğŸ“ŠğŸ“‹ğŸ“ŒğŸ“ğŸ“ğŸ“ğŸ“âœ‚ğŸ”’ğŸ”“ğŸ”ğŸ”ğŸ”‘]]},
  {"æ•°å­¦",{"ï¹¢","ï¹£","Â·","/","=","â‰¡","ï¹¤","ï¹¥","â‰¦","â‰§","â‰®","â‰¯","ï¼‹","ï¼","Ã—","Ã·","ï¼","â‰ ","ï¼œ","ï¼","â‰¤","â‰¥","â‰ˆ","â‰’","ã","ã","Î¼m","ãœ","ã","ã","â„ƒ","Â¥","$","â‚¬","à¸¿","ï¿¡","ã¡","mÂ³","ã„","ml","mol","ã•","â„‰","ï¿¥","Â£","ï¿ ","â‚ ","ã€’","âˆ","âˆ½","âˆˆ","âˆ©","âˆ§","âŠ™","âŒ’","âˆ¥","âˆŸ","âˆ£","âˆ‚","âˆ†","âˆ","â‰Œ","âˆ‰","âˆª","âˆ¨","âŠ•","âŠ¿","âŠ¥","âˆ ","âˆ«","âˆ¬","âˆ­","Â¹","Â²","Â³","â´","âµ","â¿","â¶","â·","â¸","â¹","â°","Ë£","âº","â»","â¼","â½","â¾","â€°","Â½","â…“","Â¼","â…”","Â¾","ï¼…","â‚","â‚‚","â‚ƒ","â‚„","â‚…","â‚™","â‚†","â‚‡","â‚ˆ","â‚‰","â‚€","â‚“","â‚Š","â‚‹","â‚Œ","â‚","â‚","â„…","Â°","â€²","â€³","âˆ®","âˆ¯","âˆ°"}},
--  {"åºå·",{"â‘ ","â‘¡","â‘¢","â‘£","â‘¤","â‘¥","â‘¦","â‘§","â‘¨","â‘©","â’ˆ","â’‰","â’Š","â’‹","â’Œ","â’","â’","â’","â’","â’‘","â’’","â’“","â’”","â’•","â’–","â’—","â’˜","â’™","â’š","â’›","â‘´","â‘µ","â‘¶","â‘·","â‘¸","â‘¹","â‘º","â‘»","â‘¼","â‘½","â‘¾","â‘¿","â’€","â’","â’‚","â’ƒ","â’„","â’…","â’†","â’‡","ãˆ ","ãˆ¡","ãˆ¢","ãˆ£","ãˆ¤","ãˆ¥","ãˆ¦","ãˆ§","ãˆ¨","ãˆ©","âŠ","â‹","âŒ","â","â","â","â","â‘","â’","â“","ãŠ€","ãŠ","ãŠ‚","ãŠƒ","ãŠ„","ãŠ…","ãŠ†","ãŠ‡","ãŠˆ","ãŠ‰","â…°","â…±","â…²","â…³","â…´","â…µ","â…¶","â…·","â…¸","â…¹","â… ","â…¡","â…¢","â…£","â…¤","â…¥","â…¦","â…§","â…¨","â…©"}},
--  {"ç‰¹æ®Š",{"â–³","â–½","â—‹","â—‡","â–¡","â˜†","â–²","â–¼","â—","â—†","â– ","â˜…","â–·","â—","â–¶","â—€","âˆš","Ã—","âŒ«","âœ¡","â˜‘","â˜’","âœ”","âœ˜","â˜¼","â˜½","â™€","â˜»","â—","ã‚","â˜€","â˜¾","â™‚","â˜¹","â—‘","ã˜","â˜œ","â˜","â˜","â˜š","â˜Ÿ","â˜›","â–ª","â€¢","â€¥","â€¦","âˆ·","â€»","â™©","â™ª","â™«","â™¬","Â§","Â°","â™­","â™¯","â™®","â€–","Â¶","â„–","â—","Â¤","Û","â„—","Â®","Â©","å","å","â„¡","â„¢","ã‡","Î¦","â†–","â†‘","â†—","â—¤","ãŠ¤","â—¥","â†","â†”","â†’","ãŠ§","ãŠ¥","ãŠ¨","â†™","â†“","â†˜","â—£","ãŠ¦","â—¢","â‡„","â‡…","â‡†","â‡¤","â†©","â‡¥","â","â","â—²","ã€¼","â–¢","â–£","â‡¦","â‡§","â‡¨","â‡©","â‡ª","â†¶","â–¸","â—‚","â–´","â–¾","âœ","â˜","âœ","â…","ÏŸ","ğŸ“","âœ","âœ†","â˜´","â˜²","â˜·","âš¿","â›®","âš™","â˜³","â˜¯","â˜±","â›¶","â˜©","â˜","â˜¶","â˜µ","â˜°","ğŸ’¬","ğŸ—¨","ğŸ’­","áƒ¦","âœˆ","â˜‚","ğŸ¤","ğŸŒ","ğŸ”"}},
--  {"å•ä½",[[Ã¸Ã˜Ï€Â°â€²â€³ï¼„ï¿¥ã€’ï¿ ï¿¡ï¼…ï¼ â„ƒâ„‰ï¹©ï¹ªâ€°ï¹«ã¡ã¥ã•mlãœãããmÂ³ããã„molã’ã‘Âºâ—‹Â¤%$ÂºÂ¹Â²Â³â´â¿â‚â‚‚â‚ƒâ‚„â‚¬Â£Ò°â‚´$â‚°Â¢â‚¤Â¥â‚³â‚²â‚ªâ‚µå…ƒâ‚£â‚±à¸¿Â¤â‚¡â‚®â‚­â‚©Şƒå††â‚¢â‚¥â‚«â‚¦zÅ‚ï·¼â‚ â‚§â‚¯â‚¨KÄà¤°â‚¹Æ’â‚¸ï¿ ]]},
--  {"å£°éŸµ",[[bpmfdtnlÉ¡khjqxzhchshrzcsywÉ‘ÄÃ¡ÇÃ oÅÃ³Ç’Ã²eÄ“Ã©Ä›Ã¨iÄ«Ã­ÇÃ¬uÅ«ÃºÇ”Ã¹Ã¼Ç–Ç˜ÇšÇœÃªîŸ‡Å„ÅˆîŸˆ]]},
--  {"æ‹¼éŸ³",{"É‘i","Äi","Ã¡i","Çi","Ã i","ei","Ä“i","Ã©i","Ä›i","Ã¨i","ui","uÄ«","uÃ­","uÇ","uÃ¬","É‘o","Äo","Ã¡o","Ço","Ã o","ou","Åu","Ã³u","Ç’u","Ã²u","iu","iÅ«","iÃº","iÇ”","iÃ¹","ie","iÄ“","iÃ©","iÄ›","iÃ¨","Ã¼e","Ã¼Ä“","Ã¼Ã©","Ã¼Ä›","Ã¼Ã¨","er","Ä“r","Ã©r","Ä›r","Ã¨r","É‘n","Än","Ã¡n","Çn","Ã n","en","Ä“n","Ã©n","Ä›n","Ã¨n","in","Ä«n","Ã­n","Çn","Ã¬n","un","Å«n","Ãºn","Ç”n","Ã¹n","Ã¼n","Ç–n","Ç˜n","Çšn","Çœn","É‘nÉ¡","ÄnÉ¡","Ã¡nÉ¡","ÇnÉ¡","Ã nÉ¡","enÉ¡","Ä“nÉ¡","Ã©nÉ¡","Ä›nÉ¡","Ã¨nÉ¡","inÉ¡","Ä«nÉ¡","Ã­nÉ¡","ÇnÉ¡","Ã¬nÉ¡","onÉ¡","ÅnÉ¡","Ã³nÉ¡","Ç’nÉ¡","Ã²nÉ¡","uÉ‘","uÄ","uÃ¡","uÇ","uÃ ","uo","uÅ","uÃ³","uÇ’","uÃ²","uÉ‘i","uÄi","uÃ¡i","uÇi","uÃ i","uÉ‘nÉ¡","uÄnÉ¡","uÃ¡nÉ¡","uÇnÉ¡","uÃ nÉ¡","uÉ‘n","uÄn","uÃ¡n","uÇn","uÃ n","Ã¼É‘n","Ã¼Än","Ã¼Ã¡n","Ã¼Çn","Ã¼Ã n","iÉ‘","iÄ","iÃ¡","iÇ","iÃ ","iÉ‘o","iÄo","iÃ¡o","iÇo","iÃ o","iÉ‘n","iÄn","iÃ¡n","iÇn","iÃ n","iÉ‘nÉ¡","iÄnÉ¡","iÃ¡nÉ¡","iÇnÉ¡","iÃ nÉ¡","ionÉ¡","iÅnÉ¡","iÃ³nÉ¡","iÇ’nÉ¡","iÃ²nÉ¡"}},
  {"åºå·",[[â‘ â‘¡â‘¢â‘£â‘¤â‘¥â‘¦â‘§â‘¨â‘©â‘ªâ‘«â‘¬â‘­â‘®â‘¯â‘°â‘±â‘²â‘³â“ªâ¶â·â¸â¹âºâ»â¼â½â¾â¿â“«â“¬â“­â“®â“¯â“°â“±â“²â“³â“´ãŠ€ãŠãŠ‚ãŠƒãŠ„ãŠ…ãŠ†ãŠ‡ãŠˆãŠ‰ãˆ ãˆ¡ãˆ¢ãˆ£ãˆ¤ãˆ¥ãˆ¦ãˆ§ãˆ¨ãˆ©â‘´â‘µâ‘¶â‘·â‘¸â‘¹â‘ºâ‘»â‘¼â‘½â‘¾â‘¿â’€â’â’‚â’ƒâ’„â’…â’†â’‡â’ˆâ’‰â’Šâ’‹â’Œâ’â’â’â’â’‘â’’â’“â’”â’•â’–â’—â’˜â’™â’šâ’›â… â…¡â…¢â…£â…¤â…¥â…¦â…§â…¨â…©â…ªâ…«â…°â…±â…²â…³â…´â…µâ…¶â…·â…¸â…¹â’¶â’·â’¸â’¹â’ºâ’»â’¼â’½â’¾â’¿â“€â“â“‚â“ƒâ“„â“…â“†â“‡â“ˆâ“‰â“Šâ“‹â“Œâ“â“â“â“â“‘â“’â““â“”â“•â“–â“—â“˜â“™â“šâ“›â“œâ“â“â“Ÿâ“ â“¡â“¢â“£â“¤â“¥â“¦â“§â“¨â“©â’œâ’â’â’Ÿâ’ â’¡â’¢â’£â’¤â’¥â’¦â’§â’¨â’©â’ªâ’«â’¬â’­â’®â’¯â’°â’±â’²â’³â’´â’µ]]},

    }
local è„šæœ¬å=debug.getinfo(1,"S").source:sub(2)--è·å–Luaè„šæœ¬çš„å®Œæ•´è·¯å¾„

local function Back() --ç”ŸæˆåŠŸèƒ½é”®èƒŒæ™¯
  local bka=LuaDrawable(function(c,p,d)
    local b=d.bounds
    b=RectF(b.left,b.top,b.right,b.bottom)
    p.setColor(0xffffffff)
    c.drawRoundRect(b,10,10,p) --åœ†è§’20
  end)
  local bkb=LuaDrawable(function(c,p,d)
    local b=d.bounds
    b=RectF(b.left,b.top,b.right,b.bottom)
    p.setColor(0xffc4c9ca)
    c.drawRoundRect(b,8,8,p)
  end)

  local stb=StateListDrawable()
  stb.addState({-android.R.attr.state_pressed},bkb)
  stb.addState({android.R.attr.state_pressed},bka)
  return stb
end

local function Icon(k,s) --è·å–kåŠŸèƒ½å›¾æ ‡ï¼Œæ²¡æœ‰è¿”å›s
  k=Key.presetKeys[k]
  return k and k.label or s
end

local function Bu_R(id) --ç”ŸæˆåŠŸèƒ½é”®
  local Bu={LinearLayout,
    layout_height=-1,
    layout_width=-1,
    layout_weight=1,
    padding="2dp",
    {FrameLayout,
      layout_height=-1,
      layout_width=-1,
      Background=Back(),
      {TextView,
        gravity=17|48,
        layout_height=-1,
        layout_width=-1,
        layout_marginTop="2dp",
        textColor=0xff232323,
        textSize="10dp"},
      {TextView,
        gravity=17,
        layout_height=-1,
        layout_width=-1,
        textColor=0xff232323,
        textSize="18dp"}}}
  local msg=Bu[2][2] --ä¸Šæ ‡ç­¾
  local label=Bu[2][3] --ä¸»æ ‡ç­¾

  if id==2 then
    label.text=Icon("BackSpace","âŒ«")
    label.textSize="18dp" --é»˜è®¤ç¬¦å·âŒ«å¤ªå°ï¼Œå­—ä½“å¤§å°æ”¹ä¸º22dpï¼Œåé¢åŒç†
    Bu.onClick=function()
      service.sendEvent("BackSpace")
    end
    Bu.OnLongClickListener={onLongClick=function() return true end}
   elseif id==4 then
    msg.text=Icon("undo","â†¶")
    label.text=Icon("ç¼–è¾‘","ç¼–è¾‘")
    Bu.onClick=function()
      service.editFile(è„šæœ¬å)
    end
    Bu.OnLongClickListener={onLongClick=function()
        service.sendEvent("undo")
        return true
    end}
   elseif id==1 then
    label.text=Icon("Return","â")
    label.textSize="16dp"
    Bu.onClick=function()
      service.sendEvent("Return")
    end
    Bu.OnLongClickListener={onLongClick=function() return true end}
   elseif id==3 then
    label.text=Icon("Keyboard_default","è¿”å›")
    Bu.onClick=function()
      service.sendEvent("Keyboard_default")
    end
    Bu.OnLongClickListener={onLongClick=function() return true end}
  end

  return Bu
end

local height="240dp" --é”®ç›˜é«˜åº¦
pcall(function()
  --é”®ç›˜è‡ªé€‚åº”é«˜åº¦ï¼Œæ—§ç‰ˆä¸­æ–‡ä¸æ”¯æŒï¼Œæ”¾pcallé‡Œé˜²æŠ¥é”™
  height=service.getLastKeyboardHeight()
end)
local ids,layout={},{LinearLayout,
  orientation=1,
  --é”®ç›˜é«˜åº¦
  layout_height=height,
  layout_width=-1,
  --èƒŒæ™¯é¢œè‰²
  BackgroundColor=0xffd7dddd,
  {TextView,
    layout_height="1dp",
    layout_width=-1,
    BackgroundColor=0xffdfdfdf},
  {LinearLayout,
    layout_height=-1,
    layout_width=-1,
  
  

     {LinearLayout,
      orientation=1,
      --å·¦ä¾§åŠŸèƒ½é”®å®½åº¦
      layout_width="45dp",
      layout_height=-1,
      layout_gravity=1|84,
      Bu_R(4),
      Bu_R(2),
      Bu_R(1),
      Bu_R(3)},

      
      {LinearLayout,
      id="main",
      orientation=1,
      layout_height=-1,
      layout_width=-1,
      layout_weight=1,
      {GridView, --åˆ—è¡¨æ§ä»¶
        id="list",
        numColumns=6, --6åˆ—
        paddingLeft="0dp",
        paddingRight="0dp",
        layout_width=-1,
        layout_weight=1}},
        
    {LinearLayout,
      orientation=1,
      --å³ä¾§åŠŸèƒ½é”®å®½åº¦
      layout_width="0dp",
      layout_height=-1,
      layout_gravity=1|84,
      Bu_R(4),
      Bu_R(2),
      Bu_R(1),
      Bu_R(3)}}}
layout=loadlayout(layout,ids)

local data,item={},{LinearLayout,
  layout_width=-1,
  padding="2dp",
  gravity=17,
  {CardView,
    radius="8dp",
    CardElevation=0,
    layout_width=-1,
    {TextView,
      id="a",
      padding="8dp",
      gravity=17,
      layout_width=-1,
      BackgroundColor=0xffffffff,
      textColor=0xff232323,
      textSize="19dp"}}}
local adp=LuaAdapter(service,data,item)
ids.list.Adapter=adp

--åˆ·æ–°åˆ—è¡¨
local function fresh(t)
  table.clear(data)
  if type(t)~="table" then
    local ts={}
    for a in utf8.gmatch(tostring(t),"%S")
      table.insert(ts,a)
    end
    t=ts
  end
  for _,v in ipairs(t) do
    table.insert(data,{a=v})
  end
  adp.notifyDataSetChanged()
end

ids.list.onItemClick=function(l,v,p)
  local s=data[p+1].a
  service.commitText(s)
  if utf8.len(s)>1 then
    service.sendEvent("Left")
  end
end

ids.list.onItemLongClick=function(l,v,p)
  --è¿”å›ï¼ˆçœŸï¼‰ï¼Œå¦åˆ™é•¿æŒ‰ä¹Ÿä¼šè§¦å‘ç‚¹å‡»äº‹ä»¶
  return true
end





--åˆå§‹æ˜¾ç¤ºEmojiç¬¬ä¸€é¡¹å†…å®¹
fresh(Emoji[1][2])

local Bus={LinearLayout,
  paddingLeft="2dp",
  layout_width=-1}
for _,v in ipairs(Emoji) do
  table.insert(Bus,{TextView,
    text=tostring(v[1]),
    layout_margin="2dp",
    layout_marginLeft="2dp",
    layout_marginRight="2dp",
    padding="8dp",
    gravity=17,
    layout_width=-1,
    layout_height=-1,
    layout_weight=1,
    onClick=function()
      fresh(v[2])
    end,
    OnLongClickListener={onLongClick=function() return true end},
    Background=Back(),
    textColor=0xff232323,
    textSize="15dp"})
end
ids.main.addView(loadlayout(Bus))

service.setKeyboard(layout)

