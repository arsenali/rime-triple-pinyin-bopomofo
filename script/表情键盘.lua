require "import"
import "android.widget.*"
import "android.view.*"
import "android.graphics.RectF"
import "android.graphics.drawable.StateListDrawable"

local function Back() --生成功能键背景
  local bka=LuaDrawable(function(c,p,d)
    local b=d.bounds
    b=RectF(b.left,b.top,b.right,b.bottom)
    p.setColor(0xffffffff)
    c.drawRoundRect(b,20,20,p) --圆角20
  end)
  local bkb=LuaDrawable(function(c,p,d)
    local b=d.bounds
    b=RectF(b.left,b.top,b.right,b.bottom)
    p.setColor(0xffc4c9ca)
    c.drawRoundRect(b,20,20,p)
  end)

  local stb=StateListDrawable()
  stb.addState({-android.R.attr.state_pressed},bkb)
  stb.addState({android.R.attr.state_pressed},bka)
  return stb
end

local function Icon(k,s) --获取k功能图标，没有返回s
  k=Key.presetKeys[k]
  return k and k.label or s
end

local function Bu_R(id) --生成功能键
  local Bu={LinearLayout,
    layout_height=-1,
    layout_width=-1,
    layout_weight=1,
    padding="2dp",
    {FrameLayout,
      layout_height=-1,
      layout_width=-1,
      Background=Back(),
      {TextView,
        gravity=17|48,
        layout_height=-1,
        layout_width=-1,
        layout_marginTop="2dp",
        textColor=0xff232323,
        textSize="10dp"},
      {TextView,
        gravity=17,
        layout_height=-1,
        layout_width=-1,
        textColor=0xff232323,
        textSize="18dp"}}}
  local msg=Bu[2][2] --上标签
  local label=Bu[2][3] --主标签

  if id==1 then
    label.text=Icon("BackSpace","⌫")
    label.textSize="15dp" --默认符号⌫太小，字体大小改为22dp，后面同理
    Bu.onClick=function()
      service.sendEvent("BackSpace")
    end
    Bu.OnLongClickListener={onLongClick=function() return true end}
   elseif id==2 then
    msg.text=Icon("undo","↶")
    label.text=Icon("space","␣")
    label.textSize="15dp"
    Bu.onClick=function()
      service.sendEvent("space")
    end
    Bu.OnLongClickListener={onLongClick=function()
        service.sendEvent("undo")
        return true
    end}
   elseif id==3 then
    label.text=Icon("Return","⏎")
    label.textSize="14dp"
    Bu.onClick=function()
      service.sendEvent("Return")
    end
    Bu.OnLongClickListener={onLongClick=function() return true end}
   elseif id==4 then
    label.text=Icon("Keyboard_default","返回")
    Bu.onClick=function()
      service.sendEvent("Keyboard_default")
    end
    Bu.OnLongClickListener={onLongClick=function() return true end}
  end
  return Bu
end

local height="240dp" --键盘高度
pcall(function()
  --键盘自适应高度，旧版中文不支持，放pcall里防报错
  height=service.getLastKeyboardHeight()
end)
local ids,layout={},{LinearLayout,
  orientation=1,
  --键盘高度
  layout_height=height,
  layout_width=-1,
  --背景颜色
  BackgroundColor=0xffd7dddd,
  {TextView,
    layout_height="1dp",
    layout_width=-1,
    BackgroundColor=0xffdfdfdf},
  {LinearLayout,
    layout_height=-1,
    layout_width=-1,
    {LinearLayout,
      layout_height=-1,
      layout_width=-1,
      layout_weight=1,
      {GridView, --列表控件
        id="list",
        numColumns=8, --6列
        paddingLeft="2dp",
        paddingRight="2dp",
        layout_width=-1,
        layout_weight=1},

      --可以在这里添加表情分类按钮

    },
    {LinearLayout,
      orientation=1,
      --右侧功能键宽度
      layout_width="40dp",
      layout_height=-1,
      layout_gravity=5|84,
      Bu_R(1),
      Bu_R(2),
      Bu_R(3),
      Bu_R(4)}}}
layout=loadlayout(layout,ids)

local data,item={},{LinearLayout,
  layout_width=-1,
  padding="0dp",
  gravity=17,
  {CardView,
    radius="0dp",
    CardElevation=0,
    layout_width=-1,
    {TextView,
      id="a",
      padding="8dp",
      gravity=17,
      layout_width=-1,
      BackgroundColor=0xffffffff,
      textColor=0xff232323,
      textSize="25dp"}}}
local adp=LuaAdapter(service,data,item)
ids.list.Adapter=adp

local Emoji={} --存放表情的table

--添加表情到Emoji，这里可以自己改为读取表情文件……
local 
emoji=[[
😄
😃
😀
😊
☺
😉
😍
😘
😚
😗
😜
😝
😍
😘
💗
💆
👋
🙏
🏢
🚼
👶
🍧
🐚
😭
😢
👃
🆚
😒
👎
😝
🎓
👃
😠
🏪
🏪
😣
😷
😘
😊
😍
😞
😡
😲
😂
😓
😖
😪
😜
😭
😰
😢
😃
😔
😳
😥
😨
😉
😚
😝
😌
😏
😠
😁
😒
😱
😄
🆎
🚹
🚽
⚡
🅱
⚠
🚺
♥
🚾
♦
♣
🔞
♠
➿
🚬
🚻
🅾
🚭
🅰
♿
🚼
🅿
🍦
🍦
🌊
😠
😒
🌈
🐹
🍓
🚾
🚽
☕
😝
👕
💤
😔
🏰
🏯
🍊
😲
😱
💊
🏄
🐛
🚽
🚢
🚕
🚢
📠
🔨
🌱
💩
😭
📣
🐘
😂
🈹
💉
🚲
🎂
🍰
😓
🍴
🌾
🚇
🚃
💡
☎
💻
📺
📺
🎬
🎦
🆙
🐛
🐘
🐻
🐒
🐸
🐵
🐯
🐬
🐦
🐠
🐚
🐗
🐔
🐺
🐷
🐴
🐑
🐎
🐱
🐮
🐫
🐨
🐟
🐙
🐹
🐶
🐍
🐳
🐰
🐭
🐧
🐤
🆚
☁
👿
👂
👂
🎧
💈
⛵
🍅
🍙
✈
🎐
🙈
🍁
💑
🔰
〽
🈵
㊗
✴
➡
↘
❕
🈹
🆗
⭐
🔯
⭕
❤
⬆
🈚
🔝
➿
㊙
❗
🆒
©
®
🈸
✳
🈯
❔
🈳
™
↗
🆚
🈷
❌
⬅
🆕
↙
🆙
🔱
⬇
🈶
🆔
❓
🈺
🉐
↖
💁
👢
🎩
👔
👗
👠
👒
👕
👘
👡
👙
👜
👟
👑
🍻
🍊
⛳
😊
😃
😄
🈹
🏭
🚌
✂
🔔
🔑
🔫
🔨
🔓
🔍
🔒
⛲
👸
🐗
🐶
🐶
💩
👏
👾
🍢
📢
📀
💿
😜
👻
😄
🐚
🌊
😱
😨
🐬
😳
😓
😰
💦
💦
👌
🆗
🍀
🍱
👘
😄
🎏
♠
💋
🍊
🚥
🍎
♥
🀄
🐒
🐵
🐵
🐒
🐵
🐯
💐
🎿
👑
👑
🌆
💛
💦
👋
🔥
💱
🚄
🚚
🚅
🚉
🉐
⛺
💅
🛀
🗽
💉
🀄
⛲
🎫
🎤
🎨
🎒
💊
🎬
🎡
🎥
🎢
💄
🎦
💈
⛽
🚀
🔥
🐔
🐤
🚑
📝
🎸
🍸
👫
😏
⛽
⛽
😣
→
←
↙
↗
↘
↖
⬆
⬇
⬅
➡
🏨
⛪
🏬
🏥
🏰
🏩
🏭
🏢
🏦
🏪
🏣
🏧
🏫
🏠
🏯
👷
✂
🏆
😰
💊
⛪
🚲
🚅
🚤
⛵
🚧
🚙
🚀
🚑
🚃
🚢
🚶
🚥
🚗
🚉
🚚
🚌
💺
✈
🚏
🚒
🚄
🚕
🚇
🚓
🚥
🚧
🚄
🚌
👣
🔓
💏
💍
👱
💰
😓
👮
🚓
⚠
🐳
😳
🏨
🚑
🙇
🍊
💃
😠
😡
☕
🔓
😄
🐨
🐶
🈳
😱
😷
😭
😢
🆒
💀
😭
😢
💨
😖
😪
🎺
🍜
💩
🏀
💙
🐺
💎
💙
💒
💝
💋
💚
💏
💓
💗
💛
💐
💟
💔
🌹
💘
💍
💜
💑
👵
🐯
🎰
👵
👴
🐭
👴
😂
😓
😰
💇
💈
👒
🎩
🎁
🎏
🎁
😳
🔔
🕕
😢
😭
🌀
🏠
📼
⛺
🐫
🍂
🍵
🏨
🏨
💚
🐎
🐴
🀄
🐴
🚽
⛵
🈵
🐱
🐱
🐛
🎩
👒
🌹
♣
💆
📺
📻
🍚
㊙
🌱
🍞
🍜
🐑
🎯
♑
🎡
🐮
🎃
🎃
👦
👨
🚹
😠
🐦
👧
👩
🚺
🎉
👏
🏃
🍻
🍳
🍻
🍺
😪
🎫
🍎
💰
💰
🕖
🐧
💢
😡
😠
👃
👀
👣
👂
👄
🎈
💰
👫
🔫
💪
🍆
😘
😚
😚
💏
🎈
🎉
👫
💑
☀
🐸
🎐
🎅
🎉
🎂
🎆
🎑
🎎
🎃
🎇
🎀
🎏
🎄
🎓
🎈
🎁
🍂
👊
①
②
③
④
⑤
⑥
⑦
⑧
⑨
⑩
⛽
🐠
🍲
🌅
🌄
🎷
🏁
🔱
◀
▶
🐚
⚡
💼
👆
☎
💱
📖
🐍
🎥
🈸
🆔
🈸
😷
🎅
🎄
✌
😠
😡
🎂
🎂
🔊
🔞
🖖
🖖
🚧
🕗
🕛
🕐
🕔
🕘
🕑
🕕
🕙
🕒
🕖
🕚
🕓
😌
😥
😞
🍱
🍛
🍟
🍣
🍰
🍧
🍚
🍞
🍴
🍢
🍙
🍳
🍦
🍝
🍔
🍡
🍘
🍜
🍲
☝
👋
👐
📱
🔫
👏
🙏
👈
👌
👐
🙌
👉
👍
👆
☝
👊
👎
👇
✌
✊
✋
🖖
👋
🍣
👜
🉐
📻
🎒
🐨
🐭
💤
♓
👐
♊
🌾
🍓
🍅
🍉
🍆
🍊
🍎
💤
😪
🎀
😔
🍀
🔍
🔒
🎱
☀
🍜
💨
🉐
🌀
⛄
🌂
☀
☔
☁
👼
👼
✨
🌟
🌙
💃
👿
👸
📡
💀
👾
💁
🙅
👳
💇
👶
👨
👼
👿
👮
💂
👱
🙆
👴
👦
👷
👩
👽
💀
👯
👲
💃
🙇
👵
💆
👸
👧
👻
🐰
👯
🐰
👽
🎾
🖖
💂
🚻
😃
😄
😁
♨
🈚
🐌
😄
😊
🐤
👠
👟
🍉
🍅
😍
💓
😄
😁
🚬
🌇
🛀
👇
🌵
🐘
💡
📷
🔔
🌻
😊
😄
🚒
🐶
🐤
😊
😃
🐦
😄
🐷
👠
👟
❤
🆕
💢
💦
💪
💣
💤
💨
💩
💔
💼
📣
📀
🔊
💻
📴
📫
📢
💿
📼
📳
📝
📷
📮
📡
📻
📲
📩
📠
💽
📶
📺
📱
📫
💟
🌙
🌃
🚶
🌟
✨
🍀
⛎
♒
♓
♐
♑
♏
♍
♎
♌
♊
♋
♈
♉
👉
👈
🐻
🍦
⛄
🏫
👀
🎇
🎆
🎇
🎆
👀
🐑
🔑
💊
⛺
🐗
🍃
👔
👗
💘
💉
💊
🈵
😖
🏥
🎶
🎵
🏦
🎸
🎵
🎺
🎷
🎶
🎧
🎤
🈺
🚼
👶
🌸
🍒
🈶
👉
🚃
🏣
👻
📮
🎰
📮
🏊
🐠
🐟
🈯
🈷
🌷
🎤
🎢
☔
🌂
⭕
🈷
🌙
🏆
🏊
🎿
🏃
🏀
🏄
🏈
🏁
⛳
⚽
⚾
🎾
👋
👍
💣
😜
😉
⛺
👏
🐙
📷
🍜
💅
🌴
🍁
🌸
🍀
🌷
🌻
🍃
🎍
🌺
🌾
🍂
🌵
🌹
🏁
☔
🐗
🐷
🐷
💉
🐷
🏠
🎱
🌇
🌆
🌊
🌅
🌄
🌈
🌃
💜
🚲
🗽
👣
⚽
💎
👄
👄
👈
💺
🌠🥜🏌‍♂🐥♎🥿♂💕🛶🌲🌚➰🗼🏮🙉²📂☄🚕👩‍🦽🧑‍🔬🍡🗨😗🥗☮🙍‍♂∈🗾🙎‍♂☔³⛄🧑‍🦽💅☢🥙☠🤹😪🗡⛔🔀🕉🔻🌞🟪🚸⇆⭕▪⚒🎞🧚🚵‍♂🥸🏄🦨🥄🚝⚔🍟🐌➖🐢🧙‍♀🕦👮⚠🔪🧆⛈🦈🚍🖍🙋‍♂💲🏉🍁📨📰🥣👨‍🚀×🐇🏁🪣🐻‍❄💏✈🐴🙇🐆∆🤘👨‍🌾🦙👂🍉🙋‍♀♈🌻🔬🧘‍♀🫔🧖‍♂🛌👾▲⚖🎀🪖🔍🕞🎏📦🤝🥬🕡⛴🕸🧼📔😹🤧‡✍🥺🥷🎥🚲↘🕜🤯🪅💽❓🕐☀🏓🛏🪶🪕🐟❤—🌋♾🍤🙍‍♀🤶«💟🪴📡🥾◀🌫🏹▶🔕🤏⚾🔑◼🏑😔🐕🧲🚎🧺↖🛴🟢🕒🦹🌘🧢⏺🉑📄🖥🤕¥☸🦟🌴♀😚🧋☺💘🆕🍮💻👡🥩🆔♊🛑♦🉐®⬅📑🖕🦾🍢⚰👛🚣‍♂🍑🚣🏰🦕🍾✂😎😓🙏∩📒🎣🌼🔱🧑‍🏭🫑🖋🚆🔽📲°⛸🏋‍♀🐻🚒🎋🔺🧦⛺🪃⚪🍓🌺©🦀👰😋🍹😐〽🕰🦵🍳😰🏤🈴🪜🩲🔧🚴‍♂🆎👙💜🔈∇🏂🍩🐒🚅🚮🧗‍♀🦅🧑‍✈🤐🚷🍵🤹‍♂🐛😽🔼🐗💧🕷📿🦝🚚🙆‍♂⭐🕊🐯🥃💺🥼😈😮†💥⏸⏰💝⛅🦐🐐🛳📁🌨🕴🍎📌↪🏷🏳💆🏋‍♂🧎‍♂🧎📚🧇👄📎✅🆙👳🥛🗿🤭🚗😘🙅‍♂🕛⚧🟠👌🎯🈯🏬🕌😆💩💱🧍‍♂👭▼🤦‍♂🍪🔠👸📊🪱™⏮💆‍♂📋👚🍧👊🥱🔩🧔🆗↔←🥯👫○😝🔝→🍬🧩℗🐅🦮👿👹€🩴🛡💗🧚‍♂🥁🌯🛬📤📸🏿🙋🚞👋🕺🌭🐜🍶🥟😞🚪🕶🟧🥪∞🌙🙀🦬😟🔢🦫👨‍🦽😄🏧✉💇‍♀💠🦳📹🙃🌽🟡🏪🥨🦸🍚🗺🦭🙂🫖🕙💯⏪📶Ⓜ🧪🏌‍♀🔆🪀🥻‼✋🎭🟦🍄👎🕹🗃🎨💒💖😅☕🫁🛢🦢🏚🚿🔳🍌🎼🐽🍔🚘🍍😥🥇🧍💐🀄🏆⛏📘🦚🛠🐨🍇🛩🎱🌐🕘📷🦁🐊👣📫🧁🐉🐼✏🛒🍂😤💃🎦⚛💈👧⤵⏲🕯👁🎺🎐🃏🐦🔃💉🛀🐺💂‍♀👩🌒🈺🏊‍♀👨‍🏭📞🐠⛰⚙🔓🏎👞👕🚛👮‍♂🟣🧕😒🏥👆🕵🚶‍♀👨‍🦼🧗🛸👨‍🎨🤵‍♂🐫☘🕠😛🙇‍♂🦶⛑🎊😴🧞‍♀♍🤓🤚⛹‍♀👱‍♂🧑‍🎄🙁💬🤸😨🤾🔉👬😉🌬🍏🪚🧟‍♀🚣‍♀🧨➕👅🏊‍♂🧯⛳🐏🦣🤿🎰🥦⛵🏍🏡🌱🏴‍☠🧃🦖🔡⛱📪🪝👮‍♀🕔🗜🎑🧅🧑‍💻⬛🧈📏🌵❕🪆🚄🐱👩‍🦼🪔🦆♑⬆🌡🐮🦦🥔🐑🫒☁🤦‍♀🐈⚱🦄🧝‍♀♋😼⛓🧍‍♀🍖💼🎮📺👰‍♀🦽🔏💇‍♂🧛🛁🏢✝🤜☑🍠🖨🆘☎🧎‍♀👩‍💻👩‍⚕🖇📝🦒👩‍🍳✖☣🛕🐭⚓🌈🧖‍♀👵👇🆖🧘‍♂💦🕍🏇🤲🍷🤷👲🚳🦹‍♂🦓😬👩‍🔬🤷‍♀🧏‍♀🔦🪵🔐🍀🧉♟😙🤔⛽🔣😇😜🤣🤟🧒🏄‍♀💛🧾🎽⚕🦪🎓👨‍⚖👪📻🌉🧽🎅💨🆓📣🤤🧑‍🍳🦏🏾🧟‍♂🪤⛹‍♂🦧💂🕚💇🌁🤬🌆⌨🎡🏣🤵‍♀😩📟÷🤼‍♀🚐☃🚈🚃👨‍🚒🏃‍♀🧗‍♂✨🥂🧞🌖👷😦🌎🧣🧑‍🎓🚓👴♣👩‍🚀🍆🌗🚋🤮🤫🔨🐾🌊🐄🥖🔗🏴🗣☝💓🤌👨‍🏫🩺🧑‍⚕🥮🎚💪📀⤴💾🤙💑🥏🍋⚽👐👉⏏🍥🔔🐖🦂🧠🚥🐡📕🦊·🦷🗒🍘⛪🐹🍲🤥⌛🪂😲↗🚟🧑‍💼🕋✳◽👽🪟🤎🗻🌿🐓🚽👨‍🎤↕🚏🕥🥝☂👟●🧟🧳🕵‍♂💡✔🍿🕑🈳🈸🥀😵🥈🪄🆒⌚🐲•🚇🏋🤩🔰🫐🆑🤺🎹🥭🥶🤗🧜‍♀🍻〰🏩☯🏕🌅👩‍🌾🚑❔🫂👩‍🔧🦗🕢🧛‍♂👩‍💼🩹🕗🗯👼🏘❣🕤🐶⏹😧🔄🪑🤾‍♀👤🥓🏐💢🌝🈶§🈲◯🫕🪐🐈‍⬛🌟🙎⊂🔎⬜↙🧭🚢🚌♿📉🌥🦌🌦🍈☦📴🤦☪👯‍♀☹🐰🌪💎🍺👻🛼🌓🏭👳‍♂🌀🦜🧝🌕🧡📍🤡😷🪗❄🚔🚻🏻👩‍🎨🧊🧖🙌🐷🚴‍♀👍🍰👏💣🏃‍♂🏠µ😳👀🌷🦸‍♀🏫✡🎈🎁🎉🛺🌤😏🧰🎍🚼🏳‍🌈👨‍🦯👩‍🏫🆚🧷🗓⛩🎛🏳‍⚧🕵‍♀✒👢🦍🪡👨‍🔧🦼🧚‍♀🦔😕🍞–⚫🧑🎢√♉🖐🎖💤🌑🤽‍♂⛷🕕👨‍🔬🎎🚉🐬🪰🌾🈵🛎🥞🤽🔖🏃👺🥊🧀🥡♏🥋⛹➡🌹🏀🥌🦋🔷🪁🔮💰🧿🎲♠♥🚖🔒🎟🪲➗≡🖼🙆‍♀🔯🦺👔📆🤷‍♂🌳🧤🔊👘🩱😂✴↓👝🚜👩‍⚖😭🐂🐘🩳🪛🚙🦉🍼👜♌🛣❗🛄🧵🧑‍🚀🤾‍♂🅿😖🦰🏒🦲🙈🐿😸🙅🔁👑🔚₽💄🕟🦩👷‍♀ℹ📜🌃💿🔇🫓💴😱📢👗🎙🎤🛋😯🏟💔🎻🙅‍♀🏛🦤🐤👁‍🗨🧑‍🤝‍🧑🈚◊🍱👰‍♂♐😑🥕🥐🅱🍫🖲🎳🦘👨‍🎓🍃🎃🙊📈🚶🍕👩‍🏭🙄👨‍⚕💭🌛🚵‍♀🤖🐙🤼🩰🧜‍♂🤛🔞📃🥽🦴⇅📽👳‍♀↩📵🤑🔛🏺🌰🐃🐣🙆🕣📱🧑‍⚖🖊💋🗞🛗🦥🚯♒🔅🧮🎴🟥🌏💹👩‍🚒💂‍♂🥲💌🌔🍣🧏🦃🧂🔭🪧◻🌮🍛💳🧑‍🎤👩‍🎓📥💀⏳⬇🔌🧧🛫👃🕓🦿📭🛰🤱🔋📮🤵🗝🚱🚤🦎😊🦇🖖🐸🔥🐵🧛‍♀🎒💁⛲🗂♨💁‍♂📩🔜🍯💚🍴📇🪙💊⁉🧄🐳🧑‍🏫📐🥧🧑‍🔧😍⚡💵🎶🛐🏯🏌🙍🖌🐔♻㊙👨‍🍼🤸‍♀🧙🗑🤍🏗👱‍♀🚫🤴💮😌📬🏅🧥👨‍💼🦸‍♂🤪🌂🛵💍🧑‍🚒🏵🗄👨‍💻🥠🎪₹🍅🧙‍♂🧝‍♂👖🧓🥍🪨🍒🥘🍗🚩👩‍🎤🥵🧑‍🍼🥤💸👩‍🦯😺🌧😃🕳🈂📗🔴🦯👠👦∪⏭🟤🚦➿◾🧑‍🦯🚴🦠🎇⏯🍜🎿🧬🪞🧴📅🎸🩸🥥🐞🎬🏝🅰🥅🏜🌩🏨⛎🎩🦻🈁✌🙇‍♀🪒🧑‍🎨😁🥢🔸🈹👨‍🍳🚀🟨🌌🏏🧫🧹㊗🧐🐪✊🧻🍸🧸🧱🚠🍙🦑😡❇🥒🥎🚊👓📯❌💶⏩🍝📼»🥳🥰📛▫🎠🕝🚂🚰🐩🥉😶🕎🍭🐀🤹‍♀🚹🎄🌶🍊🛂🛃🛍🟫📙🥴🎾🦱🙎‍♀🎧🌍😠🐚😿🔂🔹👒🏞🤞🏦❎🤳📓🐧⚗🏙🔲🚶‍♂🚵🪳🤢🍦🥑👨‍✈👱🛤🏼🎷🛷🤒🚺🐝¹💷💞🖱🚭📠📧🧶🤸‍♂👯↑🍐🎗⏫🗽🎫🚧🚨🚁🏊🐁🈷🤠🤰🐋💁‍♀🎆👷‍♂🧜🤼‍♂🅾👈👥🏸🐎⏬👩‍✈🎂😢🛹🛅🫀🌸🧘🔤🏈🛥🍽🧑‍🌾👩‍🍼🪘🦡🔫£🎌🤽‍♀📖🧏‍♂🦞🦹‍♀🪦🔘⏱🏖🥚💆‍♀🚾🏄‍♂🚡👨🦛🪓💙🏔🌜🍨⁻🔶🛻👯‍♂😾🟩🎵♓🌇😫👶🖤🕧🧞‍♂🔙🥫🤨🏽🚬😣🧑‍🦼🌄😀🐍🐕‍🦺😻💫📳🔵🗳🕖⚜
]]
for a in utf8.gmatch(emoji,"%S")
  table.insert(Emoji,a)
end

--刷新列表，添加Emoji里的表情
local function fresh()
  table.clear(data)
  for _,v in ipairs(Emoji) do
    table.insert(data,{a=v})
  end
  adp.notifyDataSetChanged()
end
fresh()

ids.list.onItemClick=function(l,v,p)
  local s=Emoji[p+1]
  service.commitText(s)
end

ids.list.onItemLongClick=function(l,v,p)
  --返回（真），否则长按也会触发点击事件
  return true
end

service.setKeyboard(layout)

--[[

可以自己在表情列表下面添加按钮
点击按钮清空Emoji，table.clear(Emoji)
再添加新的表情到Emoji
最后刷新一下，fresh()

]]

